"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.postController=void 0;var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,o,a){return o&&e(t.prototype,o),a&&e(t,a),t}}(),_postModel=require("post-model"),_validator=require("validator"),_imgUpload=require("img-upload"),_templateLoader=require("template-loader"),_dateHelper=require("date-helper"),PostController=function(){function e(){_classCallCheck(this,e),this.postModel=_postModel.postModel,this.validator=_validator.validator,this.uploadImg=_imgUpload.uploadImg}return _createClass(e,[{key:"createPost",value:function(e){var t=_postModel.postModel.getCurrentUser();_imgUpload.uploadImg.uploadToApi($("#image")[0].files[0]).then(function(o){var a={author:t.displayName,authorUid:t.uid,image:o.data.link,title:e.params.title,content:e.params.content,category:e.params.category,dateOfCreation:Date.now(),monthOfCreation:(0,_dateHelper.getMonthName)(),dayOfCreation:(0,_dateHelper.getDayOfCreation)(),comments:[]};_postModel.postModel.create(a),e.redirect("#/home")})}},{key:"loadCreatePostPage",value:function(e){_postModel.postModel.isUserLoggedIn().then(function(t){t?_templateLoader.templateLoader.loadTemplate("create-post","#g-app-container").then(function(){_validator.validator.validatePost()}):e.redirect("#/")})}},{key:"loadPost",value:function(e){_postModel.postModel.getPost(e.params.id).then(function(e){_templateLoader.templateLoader.loadTemplate("post","#g-app-container",e)}).catch(function(e){console.log(e)})}},{key:"loadCategory",value:function(e){_postModel.postModel.getPosts({prop:"category",value:e.params.category}).then(function(t){console.log(e.params.category),_templateLoader.templateLoader.loadTemplate("category","#g-app-container",{posts:t})}).catch(function(e){console.log(e)})}}]),e}(),postController=new PostController(_postModel.postModel,_validator.validator,_imgUpload.uploadImg);exports.postController=postController;